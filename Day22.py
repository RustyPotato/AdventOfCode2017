# Notation for direction will be as follows: 
#  0
# 3 1
#  2
# Turning to the rights = (d+1)%4
# Turning to the left   = (d-1)%4

def move(d, cX, cY):
    if (d == 0):
        cX = cX-1
    if (d == 1):
        cY = cY+1
    if (d == 2):
        cX = cX+1
    if (d == 3):
        cY = cY-1
    
    return cX, cY

def work(mp, d, x, y):
    #print("Current Pos = ", mp[x][y])
    if (mp[x][y] == '#'):
        d = (d+1)%4
        mp[x][y] = '.'
    else:
        d = (d-1)%4
        global becameInfected
        becameInfected += 1
        mp[x][y] = '#'
    
    return mp, d
    

def expandMap(mp, cX, cY):
    # If they are at the top of the map
    if (cX == 0):
        # Generate a new top line of clean nodes.
        topLine = []
        for i in range(len(mp[0])):
            topLine.append('.')
        mp.insert(0, topLine)
        cX = 1
    
    # If they are at the bottom of the map
    if (cX == len(mp)):
        # Generate a new bottom line of clean nodes.
        bottomLine = []
        for i in range(len(mp[0])):
            bottomLine.append('.')
        mp.insert(0, bottomLine)
        # cX stays the same. 
    
    # If they are at the left of the map
    if (cY == 0):
        # Add a clean node to the start every line. 
        for i in range(len(mp)):
            mp[i].insert(0, '.')
        cY = 1
    
    # If they are at the right of the map
    if (cY == len(mp[0])):
        # Add a clean node to the end every line
        for i in range(len(mp)):
            mp[i].append('.')
        # cY stays in the same place. 
    
    return mp, cX, cY

def mapPrint(mp, cX, cY):
    outStr = ""
    for i in range(len(mp)):
        for j in range(len(mp[0])):
            if (i == cX and j == cY):
                outStr += "@"
            else:
                outStr += mp[i][j]
        outStr += "\n"
    print(outStr)





mp = [\
[".",".",".","#","#",".","#",".","#",".","#","#","#","#",".",".",".","#","#","#",".",".",".",".","."],\
[".",".","#",".",".","#","#",".","#",".",".",".","#",".","#","#",".","#","#",".","#",".",".","#","."],\
[".","#",".","#",".","#",".","#","#","#",".",".",".",".","#",".",".",".","#","#","#",".",".",".","."],\
[".","#",".",".",".",".","#",".",".","#","#","#","#",".",".",".",".",".","#","#",".","#",".",".","#"],\
["#","#",".","#",".","#",".","#",".","#",".",".","#",".",".","#",".",".",".",".",".","#","#","#","."],\
["#",".",".",".","#","#",".",".",".",".","#","#",".","#","#",".","#",".","#","#",".","#","#",".","."],\
[".",".",".",".",".","#","#","#",".",".","#","#","#",".","#","#","#",".",".",".","#","#","#","#","#"],\
["#","#","#","#","#","#",".","#","#","#","#",".",".","#",".","#",".",".",".",".",".",".","#","#","."],\
["#",".",".","#","#","#",".","#","#","#","#",".",".","#","#","#","#",".",".",".",".",".",".",".","."],\
["#",".",".","#","#","#","#","#","#",".","#","#",".",".",".",".","#","#","#","#",".",".",".","#","#"],\
[".",".",".","#",".","#","#",".","#",".",".",".","#",".","#",".","#",".","#",".",".","#","#",".","#"],\
["#","#","#","#",".","#","#","#",".",".","#","#","#","#","#",".",".",".",".",".","#","#","#","#","."],\
["#",".","#",".","#",".",".",".",".","#",".","#","#","#","#",".",".",".","#","#","#","#",".",".","."],\
["#","#",".",".",".","#",".",".","#","#",".","#","#",".",".",".",".","#",".",".",".","#",".",".","."],\
[".",".",".",".",".",".","#","#",".",".","#","#",".",".","#",".",".","#",".",".","#","#","#","#","."],\
[".","#","#",".",".","#","#",".","#","#",".",".","#","#","#","#",".",".","#","#",".",".",".",".","#"],\
[".","#",".",".","#",".",".","#","#",".","#",".",".","#","#",".",".","#",".",".",".","#",".",".","."],\
["#",".","#",".","#","#",".",".",".",".",".","#","#",".",".","#","#",".","#","#","#","#","#",".","."],\
["#","#",".","#",".",".",".",".",".",".",".","#",".",".",".",".","#",".",".","#","#","#",".","#","."],\
["#","#",".",".",".","#",".",".",".","#",".",".",".",".","#","#","#",".",".","#",".","#",".","#","."],\
["#",".",".",".",".","#","#",".",".",".","#",".","#",".","#",".","#","#",".",".","#",".",".","#","#"],\
["#",".",".","#",".",".",".",".","#","#","#","#","#",".",".",".",".",".","#",".","#","#",".","#","."],\
[".","#",".",".",".","#",".",".","#",".",".","#","#","#",".",".",".",".","#","#","#",".",".","#","."],\
[".",".","#","#",".","#","#","#",".","#",".","#",".",".",".",".",".","#","#","#",".",".",".",".","."],\
["#",".","#",".","#",".","#",".","#",".","#","#",".","#","#",".",".",".","#","#",".","#","#",".","#"]]

#mp = [[".", ".", "#"], ["#", ".", "."], [".", ".", "."]]

direction = 0
becameInfected = 0
cX = len(mp)//2
cY = len(mp[0])//2

for i in range(10001):
    mapPrint(mp, cX, cY)
    if (i % 100 == 0):
        print("Tick", i)
    mp, direction = work(mp, direction, cX, cY)
    cX, cY = move(direction, cX, cY)
    mp, cX, cY = expandMap(mp, cX, cY)
    
print("Total nodes that became infected =", becameInfected-1)

# 5069 is too low...

